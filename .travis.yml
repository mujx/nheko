language: cpp
sudo: required
dist: trusty
notifications:
  email: false
matrix:
  include:
  - os: osx
    osx_image: xcode9
    compiler: clang
    env:
    - DEPLOYMENT=1
    - USE_BUNDLED_BOOST=0
    - USE_BUNDLED_SPDLOG=0
  - os: linux
    compiler: gcc
    env:
    - CXX_COMPILER=g++-7
    - C_COMPILER=gcc-7
    - QT_VERSION="-5.10.1"
    - QT_PKG=510
    - DEPLOYMENT=1
    - USE_BUNDLED_BOOST=1
    - USE_BUNDLED_SPDLOG=1
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        packages:
        - g++-7
        - ninja-build
  - os: linux
    compiler: gcc
    env:
    - CXX_COMPILER=g++-7
    - C_COMPILER=gcc-7
    - QT_VERSION=571
    - QT_PKG=57
    - USE_BUNDLED_BOOST=1
    - USE_BUNDLED_SPDLOG=1
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        packages:
        - g++-7
        - ninja-build
  - os: linux
    compiler: clang
    env:
    - CXX_COMPILER=clang++-5.0
    - C_COMPILER=clang-5.0
    - QT_VERSION=592
    - QT_PKG=59
    - USE_BUNDLED_BOOST=1
    - USE_BUNDLED_SPDLOG=1
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        - llvm-toolchain-trusty-5.0
        packages:
        - clang-5.0
        - g++-7
        - ninja-build
before_install:
- export CXX=${CXX_COMPILER}
- export CC=${C_COMPILER}
install:
    - export PATH="/usr/local/bin:$PATH"
    - ./.ci/install.sh

script:
- "./.ci/script.sh"
- "./.ci/linux/deploy.sh"
- sed -i -e "s/VERSION_NAME_VALUE/${TRAVIS_TAG}/g" ./.ci/bintray-release.json || true
- cp ./.ci/bintray-release.json .
deploy:
- provider: bintray
  user: schnuffle
  key:
    secure: wyOe9g5P9prXh/ayrGOWA1j5/pgySmcvlfs05rBfA+ZwpeI24UpbDMfZVwab8qT9r20jxAbzVNBNJ80yGv3oYN7q+eeW52sOiYpaQwRnWOLOD7dq2yyiaGIe8lnqj/SvnMxSoV57Wt5HHnPWBHjL9rjjS9gwgfLFqnCOvhGgZG9CqoS39wEzoW6amc+lMExRKhU0/hgRIaTWZIdGRUgfF02E38HuS+Fs8VLTvfEznuwasx9NiLMBcFeR81cakzojsF7SocMVyi0kzhX/ozPFiOsvg5K3uAlYsj/tALQPZ1o+JEnDV7NieNA/kkhpws/8AzKaOPAcurkYZ4A62aeG4/hxq1zdVMYaRU9fl4d8RZN+Q6YWE1j+x/CaP9x1umxFjs2tPG09B+4Fj1TliET2LDRrxmzgzuS2QoAIcSdWVCQW9YZX7zcXg2Wf5my5Nz7F/Wj11H0YYkq3+QqCz8xrx1pfN2KSF63dxgSJmgi29f+DtB1U3Ihv1cF9/Wg+DYAYHsi6/9/6lu7OKhQchuCo2acXMLIw9nXaGinTwSjZpk5ef0vlJ+DRGASzE1OMZBuV7kymloS+dhnmbH8DPplAlBERcLLn1g0N7tFfZ+udAyU7u7v49RoppAcguMQdrgTXU89aP9omdiYe5EdLfIfbIz4ET3O/vMDQo/Ren4b+DfA=
  skip_cleanup: true
  overwrite: true
  file: bintray-release.json
  on:
    condition: "$DEPLOYMENT == 1"
    repo: schnuffleit / nheko
    tags: true
